#These functions implement the inverting of a matrix, caching it's inverse 
#if that hasn't already been done and returing that inverse.

# this function creates helper functions that set and get a matrix, 
# and set and get it's cached inverse which is generated by the next function........
makeCacheMatrix <- function(x = matrix()) {
  m <- NULL
  set <- function(y) {
    x <<- y
    m <<- NULL
  }
  get <- function() x
  setinverse <- function(s) m <<- s
  getinverse <- function() m
  list(set = set, get = get,
       setinverse = setinverse,
       getinverse = getinverse)
}

#this function either returns the value of the (cached) inverse of the matrix or
# calculates, caches and returns it.
cacheSolve <- function(x, ...) {
        ## Return a matrix that is the inverse of 'x'
  m <- x$getinverse()
  if(!is.null(m)) {
    message("getting cached data")
    return(m)
  }
  data <- x$get()
  m <- solve(data, ...)
  x$setinverse(m)
  m # return(m) is better
}
# test code:
#   > v<-c(9,1,2,3,4,5,6,7,8)
# > m= matrix(v, nrow=3, ncol=3)
# > m
# [,1] [,2] [,3]
# [1,]    9    3    6
# [2,]    1    4    7
# [3,]    2    5    8
# 
# > n<-makeCacheMatrix(m)
# 
# > n$get()
# [,1] [,2] [,3]
# [1,]    9    3    6
# [2,]    1    4    7
# [3,]    2    5    8
# 
# > cacheSolve(n)
# [,1]       [,2]       [,3]
# [1,]  0.1111111 -0.2222222  0.1111111
# [2,] -0.2222222 -2.2222222  2.1111111
# [3,]  0.1111111  1.4444444 -1.2222222
# 
# > cacheSolve(n)
# getting cached data
# [,1]       [,2]       [,3]
# [1,]  0.1111111 -0.2222222  0.1111111
# [2,] -0.2222222 -2.2222222  2.1111111
# [3,]  0.1111111  1.4444444 -1.2222222
# 
# > v<-c(0.1111111,-0.2222222,0.1111111,-0.2222222,-2.2222222,1.4444444,0.1111111,2.1111111,-1.2222222)
# > v
# [1]  0.1111111 -0.2222222  0.1111111 -0.2222222 -2.2222222  1.4444444  0.1111111  2.1111111 -1.2222222
# 
# > m= matrix(v, nrow=3, ncol=3)
# 
# > n<-makeCacheMatrix(m)
# > n$get()
# [,1]       [,2]       [,3]
# [1,]  0.1111111 -0.2222222  0.1111111
# [2,] -0.2222222 -2.2222222  2.1111111
# [3,]  0.1111111  1.4444444 -1.2222222
# 
# > cacheSolve(n)
# [,1] [,2]     [,3]
# [1,] 9.000001    3 6.000001
# [2,] 1.000000    4 7.000001
# [3,] 2.000000    5 8.000001
# 
# getting cached data
# [,1] [,2]     [,3]
# [1,] 9.000001    3 6.000001
# [2,] 1.000000    4 7.000001
# [3,] 2.000000    5 8.000001
